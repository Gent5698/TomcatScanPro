# TomcatWeakPassChecker

      如果您觉得这个项目对您有帮助，别忘了点亮 Star ⭐！
      您的支持是我们继续优化和改进这个项目的动力！ 😊

## 简介

本项目是一个针对 **Tomcat** 服务的弱口令检测和 **CVE-2017-12615** 漏洞检测工具。通过该工具，您可以检测 Tomcat 的弱口令，并利用 **CVE-2017-12615** 漏洞上传并执行 WebShell。同时，工具支持通过后台部署 `WAR` 包的方式进行 `getshell` 操作。该工具支持对多个 URL 进行并发检测，并通过线程池管理资源使用，提升检测效率。

主要功能改进（新版本）

    1、支持三种 CVE-2017-12615 漏洞利用方式，并提供针对每种方式的详细日志记录。
    2、新增通过后台部署 WAR 包进行 getshell 功能，增强了工具对弱口令破解成功后的利用能力。
    3、通过配置文件灵活管理 JSP shell 和 WAR 包的内容，增强可定制性。
    4、优化了异常处理和错误日志记录，增强了工具的稳定性。
    5、动态线程池调整机制，根据任务数量调整线程数量，提升并发检测效率。

## 功能

### 1. **CVE-2017-12615 漏洞检测**
   - 工具支持三种利用方式：

      `PUT /1.jsp/`
     
      `PUT /1.jsp%20`
     
      `PUT /1.jsp::$DATA`
     
   - 成功上传后，工具会尝试访问并执行上传的 JSP 文件，判断是否能远程执行代码。
   - 对每种利用方式的结果分别记录成功或失败状态。

### 2. **弱口令检测**
   - 支持通过用户名与密码组合进行弱口令暴力破解。
   - 若登录成功，将自动尝试上传 Godzilla Webshell，提供远程访问能力。
   - 登录成功与否均会详细记录。

### 3. **后台部署 WAR 包 `getshell`**
   - 在弱口令破解成功后，工具会尝试通过 Tomcat 管理后台上传 `WAR` 包，以获取远程代码执行权限。
   - 部署的 `WAR` 包会在服务器上解压并生成 JSP Shell 文件，成功上传后，工具会访问并执行该 Shell。
   - 支持通过配置文件自定义 `WAR` 包和 Shell 文件的内容。


## 使用方法

1. 准备包含URL、用户名和密码的文本文件，分别命名为`urls.txt`、`user.txt`和`passwd.txt`。
2. 在`config.yaml`中配置文件路径和其他设置。
3. 运行脚本，将会在`success.txt`文件中记录成功的登录信息和Webshell的URL。

   ```
   python TomcatWeakPassChecker.py
   ```


![QQ20240902-165901](https://github.com/user-attachments/assets/f920d41c-1427-489f-9b34-eb649160bd12)


## 环境安装

通过以下命令安装所需模块：

```bash
pip install -r requirements.txt
```


## 注意事项

- 使用此脚本时请遵守相关法律法规，不要进行未授权的操作。
- 本脚本仅供教育和测试用途，不承担任何由不当使用造成的后果。


使用有什么问题或改进想法，在Issues提出
